<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>GoCafe</title>
    <link rel="icon" href="/favicon.ico"/>

    <!-- ê³µìš©/ì»´í¬ë„ŒíŠ¸/í…Œë§ˆ ìˆœì„œ -->
    <link rel="stylesheet" href="/css/tw-shim.css"/>
    <link rel="stylesheet" href="/css/detail.css"/>
    <link rel="stylesheet" href="/css/owner-modal.css"/>
    <link rel="stylesheet" href="/css/alert.css"/>
    <link rel="stylesheet" href="/css/footer.css"/>
    <link rel="stylesheet" href="/css/cafego.css"/>
    <link rel="stylesheet" href="/css/theme-green.css"/>
    <link rel="stylesheet" href="/css/cafes.css"/>

</head>
<body class="{{#isLoggedIn}}is-logged-in{{/isLoggedIn}}">

<nav class="cg-nav">
    <div class="cg-container cg-nav__inner">
        <a href="/" class="cg-brand" aria-label="GoCafe">GoCafe</a>

        <ul class="cg-navlinks cg-navlinks--left">
            <li><a href="/main"       class="{{#isHome}}cg-nav-active{{/isHome}}">í™ˆ</a></li>
            <li><a href="/index/map"  class="{{#isMap}}cg-nav-active{{/isMap}}">íƒìƒ‰ ì§€ë„</a></li>
            <li>
                <a href="/cafes"
                   id="openOnboarding"
                   data-open="onboarding"
                   class="{{#isCafes}}cg-nav-active{{/isCafes}}">
                    ì¹´í˜ ì°¾ê¸°
                </a>
            </li>
            <li><a href="/missions"   class="{{#isMissions}}cg-nav-active{{/isMissions}}">ë¯¸ì…˜</a></li>
            <li><a href="/reviews"    class="{{#isReviews}}cg-nav-active{{/isReviews}}">ë¦¬ë·°</a></li>
        </ul>

        <div class="cg-nav__actions">
            {{^isLoggedIn}}
                <div class="cg-auth-out">
                    <a href="/signup" class="cg-btn-outline">íšŒì›ê°€ì…</a>
                    <a href="/login"  class="cg-btn">ë¡œê·¸ì¸</a>
                </div>
            {{/isLoggedIn}}

            {{#isLoggedIn}}
                <div class="cg-auth-in">
                    <span class="cg-me-email">{{currentUserNickname}}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!</span>
                    <div class="cg-noti">
                        <button id="notiBtn" class="cg-btn-outline" type="button">ğŸ”” <span id="notiCount">{{notificationCount}}</span></button>
                        <div id="notiDropdown" class="cg-dropdown" aria-label="ì•Œë¦¼ ëª©ë¡">
                            <ul id="notiList" class="cg-dropdown__list"></ul>
                            <div class="cg-dropdown__footer">
                                <button id="notiReadAll" class="cg-btn-outline" type="button">ëª¨ë‘ ì½ìŒ</button>
                            </div>
                        </div>
                    </div>
                    <a href="/member/me" class="cg-btn-outline">ë§ˆì´í˜ì´ì§€</a>
                    {{#isAdmin}}<a href="/admin" class="cg-btn-outline">ê´€ë¦¬ì</a>{{/isAdmin}}
                    <form id="logoutForm" action="/api/auth/logout" method="post" style="display:inline;">
                        <button id="logoutBtn" class="cg-btn-outline" type="button">ë¡œê·¸ì•„ì›ƒ</button>
                    </form>
                </div>
            {{/isLoggedIn}}
        </div>
    </div>
</nav>
<script>
    document.getElementById('logoutBtn')?.addEventListener('click', async () => {
      try {
        await fetch('/api/auth/logout', { method: 'POST', credentials: 'include', keepalive: true });
      } finally {
        try {
          localStorage.removeItem('AT'); localStorage.removeItem('RT');
          sessionStorage.removeItem('AT'); sessionStorage.removeItem('RT');
        } catch {}
        location.reload();
      }
    });
</script>
{{#flashInfo}}<div class="cg-flash-info">{{flashInfo}}</div>{{/flashInfo}}
