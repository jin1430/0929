{{>layout/header}}

<main class="cg-container cafe-create">
    <!-- 페이지 타이틀 -->
    <section class="cc-hero">
        <h1 class="cc-title">카페 등록</h1>
        <p class="cc-sub">새로운 카페를 등록하고 많은 사람들에게 알려보세요!</p>
    </section>

    <!-- 스텝 인디케이터 -->
    <section class="cc-steps">
        <div class="cc-step is-active">
            <span class="cc-step__num">1</span><span class="cc-step__label">기본 정보</span>
        </div>
        <div class="cc-step">
            <span class="cc-step__num">2</span><span class="cc-step__label">상세 정보</span>
        </div>
        <div class="cc-step">
            <span class="cc-step__num">3</span><span class="cc-step__label">서류 제출</span>
        </div>
    </section>

    <!-- 폼 -->
    <form id="cafeCreateForm" class="cc-form" method="post" action="/cafes/create" enctype="multipart/form-data" autocomplete="off">
        <!-- 기본 정보 -->
        <section class="cc-card">
            <header class="cc-card__head">
                <div class="cc-card__index">1</div>
                <div>
                    <h2 class="cc-card__title">기본 정보</h2>
                    <p class="cc-card__desc">카페 등록 후 관리자 승인을 거쳐 서비스에 노출됩니다.</p>
                </div>
            </header>

            <div class="cc-grid-2">
                <!-- ✔︎ 엔티티/폼: name -->
                <label class="cc-field">
                    <span class="cc-label">카페명 <span class="req">*</span></span>
                    <input name="name" maxlength="10" required class="cc-input" placeholder="카페명을 입력하세요 (최대 10자)">
                    <small class="cc-hint">최대 10자까지 입력 가능합니다.</small>
                </label>

                <!-- ✔︎ CafeForm: number (서비스에서 getNumber() 사용) -->
                <label class="cc-field">
                    <span class="cc-label">전화번호 <span class="req">*</span></span>
                    <input name="phoneNumber" maxlength="15" class="cc-input" placeholder="02-1234-5678" required>
                    <small class="cc-hint">하이픈(-) 포함하여 입력해주세요.</small>
                </label>
            </div>

            <!-- ✔︎ 엔티티/폼: address -->
            <label class="cc-field">
                <span class="cc-label">주소 <span class="req">*</span></span>
                <div class="cc-address">
                    <input name="address" maxlength="60" required class="cc-input" placeholder="카페 주소를 입력하세요 (최대 60자)">
                    <button type="button" id="btnFindAddr" class="cg-btn-outline">주소 검색</button>
                </div>
                <small class="cc-hint">정확한 주소를 입력해주세요. 지도에서 위치가 자동으로 설정됩니다.</small>
            </label>

            <div class="cc-grid-2">
                <!-- ✔︎ 엔티티/폼: lat, lon -->
                <label class="cc-field">
                    <span class="cc-label">위도 (lat) <span class="req">*</span></span>
                    <input name="lat" type="number" step="0.000001" class="cc-input" placeholder="37.123456" required readonly>
                    <small class="cc-hint">주소 검색 시 자동으로 입력됩니다.</small>
                </label>

                <label class="cc-field">
                    <span class="cc-label">경도 (lon) <span class="req">*</span></span>
                    <input name="lon" type="number" step="0.000001" class="cc-input" placeholder="127.123456" required readonly>
                    <small class="cc-hint">주소 검색 시 자동으로 입력됩니다.</small>
                </label>
            </div>
        </section>

        <!-- 사업자 정보 -->
        <section class="cc-card">
            <header class="cc-card__head">
                <div class="cc-card__index">2</div>
                <div>
                    <h2 class="cc-card__title">사업자 정보</h2>
                    <p class="cc-card__desc">사업자 정보를 정확히 입력해주세요.</p>
                </div>
            </header>

            <div class="cc-grid-2">
                <!-- ✔︎ 엔티티/폼: businessCode -->
                <label class="cc-field">
                    <span class="cc-label">사업자 코드 <span class="req">*</span></span>
                    <input name="businessCode" maxlength="10" class="cc-input" placeholder="123-45-67890" required>
                    <small class="cc-hint">사업자등록번호를 입력해주세요.</small>
                </label>

                <!-- ✔︎ 엔티티/폼: creationDate (LocalDate) -->
                <label class="cc-field">
                    <span class="cc-label">개업일 <span class="req">*</span></span>
                    <input name="creationDate" type="date" class="cc-input" required>
                    <small class="cc-hint">카페 개업일을 선택해주세요.</small>
                </label>
            </div>
        </section>

        <!-- 사진/증빙 업로드 -->
        <section class="cc-card">
            <header class="cc-card__head">
                <div class="cc-card__index">3</div>
                <div>
                    <h2 class="cc-card__title">사진 · 검증</h2>
                    <p class="cc-card__desc">대표 사진과 사업자 증빙을 첨부하세요.</p>
                </div>
            </header>

            <div class="cc-grid-2">
                <!-- ✔︎ 파일 이름: cafePhotoFile (서비스 createCafe의 파라미터명과 일치) -->
                <label class="cc-field">
                    <span class="cc-label">대표 사진</span>

                    <!-- 원클릭 업로더 (input이 박스를 투명하게 전체 덮음) -->
                    <label class="cc-uploader">
                        <input id="cafePhotoFile" name="cafePhotoFile" type="file" accept="image/*" class="cc-file">
                        <div class="cc-uploader__body">
                            <div class="cc-thumb" aria-hidden="true"></div>
                            <p>📷 클릭하거나 파일을 드롭하세요</p>
                            <small id="cafePhotoName" class="cc-file-name"></small>
                        </div>
                    </label>
                    <small class="cc-hint">JPG/PNG 권장. 첫 업로드는 자동으로 대표 지정됩니다.</small>
                </label>

                <!-- ✔︎ 파일 이름: bizDocFile (서비스 createCafe의 파라미터명과 일치) -->
                <label class="cc-field">
                    <span class="cc-label">사업자 등록증</span>
                    <label class="cc-uploader">
                        <input id="bizDocFile" name="bizDocFile" type="file" accept=".pdf,image/*" class="cc-file">
                        <div class="cc-uploader__body">
                            <div class="cc-thumb" aria-hidden="true"></div>
                            <p>📄 클릭하거나 파일을 드롭하세요</p>
                            <small id="bizDocName" class="cc-file-name"></small>
                        </div>
                    </label>
                    <small class="cc-hint">PDF/JPG 허용. 선택사항이지만 승인 과정이 빨라집니다.</small>
                </label>
            </div>
        </section>

        <!-- 약관 동의 -->
        <section class="cc-card">
            <h3 class="cc-card__title">약관 동의</h3>

            <label class="cc-check">
                <input type="checkbox" required>
                <span class="cc-check__text">[필수] 카페 등록 이용약관에 동의합니다.</span>
            </label>
            <label class="cc-check">
                <input type="checkbox" required>
                <span class="cc-check__text">[필수] 개인정보 수집 및 이용에 동의합니다.</span>
            </label>
            <label class="cc-check">
                <input type="checkbox">
                <span class="cc-check__text">[선택] 마케팅 정보 수신에 동의합니다.</span>
            </label>

            <div class="cc-actions">
                <a href="/main" class="cg-btn-outline cc-btn">취소</a>
                <button type="submit" class="cg-btn cc-btn cc-btn--primary">카페 등록 신청</button>
            </div>
        </section>

        <!-- 안내 -->
        <section class="cc-note">
            <h4>📋 등록 안내사항</h4>
            <ul>
                <li>카페 등록 신청 후 관리자 검토를 거쳐 승인됩니다. (보통 1~3일)</li>
                <li>승인 완료 시 등록하신 이메일로 알림을 보내드립니다.</li>
                <li>허위 정보나 부적절한 내용이 발견될 경우 등록이 거부될 수 있습니다.</li>
                <li>사업자등록증을 함께 제출하시면 승인 과정이 빨라집니다.</li>
                <li>등록 후 카페 정보 수정은 마이페이지에서 가능합니다.</li>
            </ul>
        </section>
    </form>
</main>

{{>layout/footer}}

<!-- 페이지 전용 스타일 (스코프: .cafe-create) -->
<style>
    .cafe-create .req{color:#ef4444;}
    .cafe-create .cc-hero{margin-top:12px;margin-bottom:8px}
    .cafe-create .cc-title{font-size:32px;font-weight:800;color:#1f2937;margin:0}
    .cafe-create .cc-sub{color:#6b7280;margin-top:4px}

    .cafe-create .cc-steps{display:flex;gap:24px;align-items:center;margin:18px 0 10px}
    .cafe-create .cc-step{display:flex;align-items:center;gap:8px;color:#6b7280}
    .cafe-create .cc-step.is-active{color:#10b981}
    .cafe-create .cc-step__num{width:28px;height:28px;display:inline-flex;align-items:center;justify-content:center;border-radius:50%;background:#e5f7f1;color:#10b981;font-weight:800}

    .cafe-create .cc-form{margin-top:6px}
    .cafe-create .cc-card{background:#fff;border:1px solid #e5e7eb;border-radius:16px;padding:18px 18px 14px;margin-bottom:16px;box-shadow:0 6px 16px rgba(0,0,0,.04)}
    .cafe-create .cc-card__head{display:flex;gap:10px;align-items:center;margin-bottom:10px}
    .cafe-create .cc-card__index{width:28px;height:28px;border-radius:50%;background:#10b981;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:800}
    .cafe-create .cc-card__title{margin:0;font-size:18px;font-weight:800;color:#1f2937}
    .cafe-create .cc-card__desc{margin:2px 0 0;color:#6b7280}

    .cafe-create .cc-grid-2{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    @media (max-width:900px){.cafe-create .cc-grid-2{grid-template-columns:1fr}}
    .cafe-create .cc-field{display:block}
    .cafe-create .cc-label{display:block;margin-bottom:6px;font-weight:700;color:#374151}
    .cafe-create .cc-input{width:100%;height:44px;border:1px solid #d1d5db;border-radius:12px;padding:0 12px}
    .cafe-create .cc-input[readonly]{background:#f9fafb}
    .cafe-create .cc-hint{display:block;margin-top:6px;color:#6b7280;font-size:12px}

    .cafe-create .cc-address{display:flex;gap:8px}
    .cafe-create .cc-address .cc-input{flex:1}

    /* 원클릭 업로더 */
    .cafe-create .cc-uploader{position:relative;display:block;border:2px dashed #d1d5db;border-radius:12px;padding:22px;text-align:center;background:#fafafa}
    .cafe-create .cc-uploader:hover{background:#f5f5f5}
    .cafe-create .cc-file{position:absolute;inset:0;opacity:0;cursor:pointer}
    .cafe-create .cc-uploader__body{pointer-events:none}
    .cafe-create .cc-thumb{width:56px;height:56px;margin:0 auto 8px;border-radius:12px;background:linear-gradient(135deg,#3aa17e,#4fb894);opacity:.15}
    .cafe-create .cc-file-name{display:block;color:#374151;margin-top:6px}

    .cafe-create .cc-check{display:flex;align-items:flex-start;gap:10px;margin:8px 0}
    .cafe-create .cc-check input{margin-top:3px}
    .cafe-create .cc-check__text{color:#374151}

    .cafe-create .cc-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:12px}
    .cafe-create .cc-btn{height:44px;padding:0 18px;border-radius:12px}
    .cafe-create .cc-btn--primary{background:#3aa17e;border:0;color:#fff;font-weight:700}

    .cafe-create .cc-note{border:1px solid #bfdbfe;background:#eff6ff;border-radius:16px;padding:16px;margin:18px 0}
    .cafe-create .cc-note h4{margin:0 0 8px;color:#1e40af}
    .cafe-create .cc-note ul{margin:0;padding-left:18px;color:#1e3a8a}
</style>

<!-- 페이지 전용 스크립트 -->
<script>
    // 업로드 파일명 표시
    (function(){
      const photo = document.getElementById('cafePhotoFile');
      const photoName = document.getElementById('cafePhotoName');
      const biz = document.getElementById('bizDocFile');
      const bizName = document.getElementById('bizDocName');

      if (photo) photo.addEventListener('change', e=>{
        photoName.textContent = e.target.files?.[0]?.name || '';
      });
      if (biz) biz.addEventListener('change', e=>{
        bizName.textContent = e.target.files?.[0]?.name || '';
      });
    })();

    // 주소 검색 → 위/경도 자동 입력 (임시 Mock; 실제 서비스에선 카카오/네이버 API 연동)
    (function(){
      const btn = document.getElementById('btnFindAddr');
      if (!btn) return;
      btn.addEventListener('click', ()=>{
        const addr = document.querySelector('input[name="address"]');
        const lat  = document.querySelector('input[name="lat"]');
        const lon  = document.querySelector('input[name="lon"]');
        if (!addr || !lat || !lon) return;

        if (!addr.value.trim()){
          alert('주소를 먼저 입력해주세요.');
          addr.focus();
          return;
        }

        // 주소에 포함된 구명에 따라 임시 좌표 부여
        const table = {
          '강남구': {lat:37.5173, lon:127.0473},
          '서초구': {lat:37.4837, lon:127.0324},
          '마포구': {lat:37.5663, lon:126.9019},
          '종로구': {lat:37.5735, lon:126.9788}
        };
        const key = Object.keys(table).find(k => addr.value.includes(k));
        const coord = key ? table[key] : {lat:37.5665, lon:126.9780};

        lat.value = coord.lat;
        lon.value = coord.lon;
        alert('위치가 자동으로 설정되었습니다.');
      });
    })();
</script>
